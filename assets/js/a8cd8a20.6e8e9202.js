"use strict";(self.webpackChunkgephi_documentation=self.webpackChunkgephi_documentation||[]).push([[2546],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>c});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var p=n.createContext({}),s=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},m=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),d=s(r),c=i,h=d["".concat(p,".").concat(c)]||d[c]||u[c]||o;return r?n.createElement(h,a(a({ref:t},m),{},{components:r})):n.createElement(h,a({ref:t},m))}));function c(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=r.length,a=new Array(o);a[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:i,a[1]=l;for(var s=2;s<o;s++)a[s]=r[s];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},1981:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var n=r(7462),i=(r(7294),r(3905));const o={id:"import",title:"Import"},a=void 0,l={unversionedId:"Plugins/import",id:"Plugins/import",title:"Import",description:"This HowTo shows, in about 15 minutes how to create a new importer in Gephi. Importers push data from files, databases or external datasources to a Container. The role of the container is to host all data collected by importers (i.e. nodes, edges and attributes). This HowTo is focused on file importers, but the procedure is slightly similar for databases or spigots.",source:"@site/docs/04_Plugins/Import.md",sourceDirName:"04_Plugins",slug:"/Plugins/import",permalink:"/gephi-documentation/Plugins/import",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/04_Plugins/Import.md",tags:[],version:"current",frontMatter:{id:"import",title:"Import"},sidebar:"tutorialSidebar",previous:{title:"GraphStreaming",permalink:"/gephi-documentation/Plugins/graphstreaming"},next:{title:"Layout",permalink:"/gephi-documentation/Plugins/layout"}},p={},s=[{value:"Create a new Importer",id:"create-a-new-importer",level:2},{value:"Set Dependencies",id:"set-dependencies",level:3},{value:"Create FileImporterBuilder",id:"create-fileimporterbuilder",level:3},{value:"Create FileImporter",id:"create-fileimporter",level:3},{value:"Finish the builder",id:"finish-the-builder",level:3},{value:"With settings UI",id:"with-settings-ui",level:2},{value:"Create MyImporterUI",id:"create-myimporterui",level:3},{value:"Register the UI",id:"register-the-ui",level:3},{value:"Advices",id:"advices",level:2},{value:"How to write a text file importer",id:"how-to-write-a-text-file-importer",level:3},{value:"How to write an XML file importer",id:"how-to-write-an-xml-file-importer",level:3},{value:"How to handle errors and exceptions",id:"how-to-handle-errors-and-exceptions",level:3}],m={toc:s};function u(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This HowTo shows, in about 15 minutes how to create a new importer in Gephi. Importers push data from files, databases or external datasources to a ",(0,i.kt)("inlineCode",{parentName:"p"},"Container"),". The role of the container is to host all data collected by importers (i.e. nodes, edges and attributes). This HowTo is focused on file importers, but the procedure is slightly similar for databases or spigots."),(0,i.kt)("p",null,"Please look at [","[Plugin Quick Start]","] to know how to create a new Netbeans Module. When you have your plugin module, that we will call ",(0,i.kt)("em",{parentName:"p"},"MyImporter"),", you can start this tutorial."),(0,i.kt)("p",null,"One can find file importer examples in the Gephi ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/gephi/gephi/tree/master/modules/ImportPlugin/src/main"},"source code"),"."),(0,i.kt)("h2",{id:"create-a-new-importer"},"Create a new Importer"),(0,i.kt)("h3",{id:"set-dependencies"},"Set Dependencies"),(0,i.kt)("p",null,"Add ",(0,i.kt)("inlineCode",{parentName:"p"},"ImportAPI"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"LongTaskAPI"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"FileSystemAPI"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"UtilitiesAPI")," and Lookup modules as dependencies for your plugin module ",(0,i.kt)("em",{parentName:"p"},"MyImport"),". See [","[How To Set Module Dependencies]","]."),(0,i.kt)("h3",{id:"create-fileimporterbuilder"},"Create FileImporterBuilder"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ImporterBuilder")," is a factory class for building the important instance, all Importers should have their own builder."),(0,i.kt)("li",{parentName:"ul"},"Create a new builder class, for instance ",(0,i.kt)("em",{parentName:"li"},"MyImporterBuilder")," that implements ",(0,i.kt)("inlineCode",{parentName:"li"},"FileImporterBuilder"),"."),(0,i.kt)("li",{parentName:"ul"},"Fill the ",(0,i.kt)("inlineCode",{parentName:"li"},"getFileTypes()")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"getName()")," methods like below, for a single file format supported named ",(0,i.kt)("em",{parentName:"li"},"foo"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public String getName() {\n   return "foo";\n}\n \npublic FileType[] getFileTypes() {\n   return new FileType[]{new FileType(".foo", "Foo files")};\n}\n')),(0,i.kt)("p",null,"Add ",(0,i.kt)("inlineCode",{parentName:"p"},"@ServiceProvider")," annotation to your builder class. Add the following line before ",(0,i.kt)("em",{parentName:"p"},"MyImporterBuilder")," class definition, as shown below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@ServiceProvider(service = FileImporterBuilder.class)\npublic class MyImporterBuilder implements FileImporterBuilder {\n...\n")),(0,i.kt)("h3",{id:"create-fileimporter"},"Create FileImporter"),(0,i.kt)("p",null,"The importer is where the job will be done. Create a new importer class, for instance ",(0,i.kt)("em",{parentName:"p"},"MyImporter")," that implements ",(0,i.kt)("inlineCode",{parentName:"p"},"FileImporter"),"."),(0,i.kt)("p",null,"Notice the ",(0,i.kt)("inlineCode",{parentName:"p"},"setReader()")," method. That means you will work with a reader instead directly with files. The system is responsible of setting the reader before the importer you're developing will be executed."),(0,i.kt)("p",null,"Add also ",(0,i.kt)("inlineCode",{parentName:"p"},"LongTask")," interface to your class, in order you will be able to use progress and cancel management.\nYour ",(0,i.kt)("em",{parentName:"p"},"MyImporter")," would look like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class MyImporter implements FileImporter, LongTask {\n \n   private Reader reader;\n   private ContainerLoader container;\n   private Report report;\n   private ProgressTicket progressTicket;\n   private boolean cancel = false;\n \n   public void setReader(Reader reader) {\n      this.reader = reader;\n   }\n \n   public boolean execute(ContainerLoader loader) {\n      this.container = loader;\n      this.report = new Report();\n      //Import\n      return !cancel;\n   }\n \n   public ContainerLoader getContainer() {\n      return container;\n   }\n \n   public Report getReport() {\n      return report;\n   }\n \n   public boolean cancel() {\n      cancel = true;\n      return true;\n   }\n \n   public void setProgressTicket(ProgressTicket progressTicket) {\n      this.progressTicket = progressTicket;\n   }\n}\n")),(0,i.kt)("p",null,"The infrastructure is set, the container for pushing data, the report for pushing logs and errors, and the progress management."),(0,i.kt)("h3",{id:"finish-the-builder"},"Finish the builder"),(0,i.kt)("p",null,"Go back to the ",(0,i.kt)("em",{parentName:"p"},"MyImporterBuilder")," and complete ",(0,i.kt)("inlineCode",{parentName:"p"},"buildImporter()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"isMatchingImporter()")," methods:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public FileImporter buildImporter() {\n   return new MyImporter();\n}\n \npublic boolean isMatchingImporter(FileObject fileObject) {\n   return fileObject.getExt().equalsIgnoreCase("foo");\n}\n')),(0,i.kt)("h2",{id:"with-settings-ui"},"With settings UI"),(0,i.kt)("p",null,"You can create an ",(0,i.kt)("inlineCode",{parentName:"p"},"ImporterUI")," class for your importer. It is not mandatory and the importer will work normally with default settings."),(0,i.kt)("h3",{id:"create-myimporterui"},"Create MyImporterUI"),(0,i.kt)("p",null,"Create a new ",(0,i.kt)("inlineCode",{parentName:"p"},"ImporterUI")," class, for instance ",(0,i.kt)("em",{parentName:"p"},"MyImporterUI")," that implements ",(0,i.kt)("a",{parentName:"p",href:"http://gephi.org/docs/api/org/gephi/io/importer/spi/ImporterUI.html"},(0,i.kt)("inlineCode",{parentName:"a"},"ImporterUI")),"."),(0,i.kt)("p",null,"Your UI class is responsible of providing the JPanel associated to your importer and set settings value to your ",(0,i.kt)("em",{parentName:"p"},"MyImporter")," instance. The system will ask for a JPanel, show a setting dialog and then call ",(0,i.kt)("inlineCode",{parentName:"p"},"unsetup()"),". If users validate the settings panel by hitting OK, the ",(0,i.kt)("inlineCode",{parentName:"p"},"unsetup()")," method is called with update set as true and ask the UI to write the setting values.\nThe sample below will help you:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class MyImporterUI implements ImporterUI {\n \n   private JPanel panel;\n   private JCheckBox option;\n   private MyImporter importer;\n \n   public void setup(Importer importer) {\n     this.importer = (MyImporter)importer;\n   }\n \n   public JPanel getPanel() {\n     panel = new JPanel();\n     option = new JCheckBox("Option");\n     panel.add(option);\n     return panel;\n   }\n \n   public void unsetup(boolean update) {\n     if(update) {\n        importer.setOption(option.isSelected());\n     }\n     panel = null;\n     importer = null;\n     option = null;\n   }\n \n   public String getDisplayName() {\n     return "Importer Foo";\n   }\n \n   public boolean isUIForImporter(Importer importer) {\n     return importer instanceof MyImporter;\n   }\n}\n')),(0,i.kt)("p",null,"In the example below, notice the ",(0,i.kt)("inlineCode",{parentName:"p"},"importer.setOption(option.isSelected())")," line. The ",(0,i.kt)("inlineCode",{parentName:"p"},"setOption()")," method doesn't exist in ",(0,i.kt)("em",{parentName:"p"},"MyImporter")," but it shows how to configure it easily."),(0,i.kt)("h3",{id:"register-the-ui"},"Register the UI"),(0,i.kt)("p",null,"Add ",(0,i.kt)("inlineCode",{parentName:"p"},"@ServiceProvider")," annotation to your UI class. Add the following line before ",(0,i.kt)("em",{parentName:"p"},"MyImporterUI")," class definition, as shown below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@ServiceProvider(service = ImporterUI.class)\npublic class MyImporterUIimplements ImporterUI{\n...\n")),(0,i.kt)("h2",{id:"advices"},"Advices"),(0,i.kt)("h3",{id:"how-to-write-a-text-file-importer"},"How to write a text file importer"),(0,i.kt)("p",null,"The best way for text files is to use a ",(0,i.kt)("inlineCode",{parentName:"p"},"LineNumberReader"),".\nOne can get it from the ",(0,i.kt)("inlineCode",{parentName:"p"},"ImportUtils")," class:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"LineNumberReader lineReader = ImportUtils.getTextReader(reader);")),(0,i.kt)("h3",{id:"how-to-write-an-xml-file-importer"},"How to write an XML file importer"),(0,i.kt)("p",null,"XML files can be read with different methods (DOM, SAX, StAX) in Java.\n",(0,i.kt)("a",{parentName:"p",href:"http://www.wikiwand.com/en/StAX"},"StAX")," is combining simplicity and efficiency and should be favored to read XML files:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"XMLStreamReader xmLReader = ImportUtils.getXMLReader(reader);")),(0,i.kt)("p",null,"Thought it is not recommended to use DOM as it's too much memory consuming, here is how to get a Document from the reader:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Document document = ImportUtils.getXMLDocument(reader);")),(0,i.kt)("h3",{id:"how-to-handle-errors-and-exceptions"},"How to handle errors and exceptions"),(0,i.kt)("p",null,"Warnings and errors are generated by importers to let users get feedback about the import process. Data is rarely clean and perfectly formated, thus it's necessary to give a specific error message for each problem. The report present in your importer class is here for that."),(0,i.kt)("p",null,"Similar as classical logging framework, that is how to log a information message:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},'report.logIssue(new Issue("The attribute label has been found", Issue.Level.INFO));')),(0,i.kt)("p",null,"There are four levels: ",(0,i.kt)("strong",{parentName:"p"},"INFO"),", ",(0,i.kt)("strong",{parentName:"p"},"WARNING"),", ",(0,i.kt)("strong",{parentName:"p"},"SEVERE"),", ",(0,i.kt)("strong",{parentName:"p"},"CRITICAL"),". Note that the critical level will stop the import process and throw an exception, so it is reserved if the file cannot be read or the XML is not valid for instance.\nAbout exceptions, it is recommended that you throw ",(0,i.kt)("inlineCode",{parentName:"p"},"RuntimeException")," from your execute method. They will be properly catched and displayed to users in a message box."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cloud.githubusercontent.com/assets/177962/5606728/a8cd1f40-943c-11e4-87cf-9dc27f21bce2.png",alt:"image"})))}u.isMDXComponent=!0}}]);