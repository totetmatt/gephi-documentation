"use strict";(self.webpackChunkgephi_documentation=self.webpackChunkgephi_documentation||[]).push([[3945],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>m});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),s=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},d=function(e){var t=s(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),c=s(r),m=i,g=c["".concat(l,".").concat(m)]||c[m]||u[m]||a;return r?n.createElement(g,o(o({ref:t},d),{},{components:r})):n.createElement(g,o({ref:t},d))}));function m(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,o=new Array(a);o[0]=c;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:i,o[1]=p;for(var s=2;s<a;s++)o[s]=r[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},1135:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>p,toc:()=>s});var n=r(7462),i=(r(7294),r(3905));const a={id:"spigot-importer-with-wizard",title:"Spigot importer with Wizard"},o=void 0,p={unversionedId:"Plugins/spigot-importer-with-wizard",id:"Plugins/spigot-importer-with-wizard",title:"Spigot importer with Wizard",description:"Introduction",source:"@site/docs/04_Plugins/Spigot-importer-with-Wizard.md",sourceDirName:"04_Plugins",slug:"/Plugins/spigot-importer-with-wizard",permalink:"/gephi-documentation/Plugins/spigot-importer-with-wizard",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/04_Plugins/Spigot-importer-with-Wizard.md",tags:[],version:"current",frontMatter:{id:"spigot-importer-with-wizard",title:"Spigot importer with Wizard"},sidebar:"tutorialSidebar",previous:{title:"Spatialisations (FR)",permalink:"/gephi-documentation/Plugins/spatialisations-(fr)"},next:{title:"Statistics",permalink:"/gephi-documentation/Plugins/statistics"}},l={},s=[{value:"Introduction",id:"introduction",level:2},{value:"Create a new Importer",id:"create-a-new-importer",level:2},{value:"Set Dependencies",id:"set-dependencies",level:3},{value:"Create SpigotImporterBuilder",id:"create-spigotimporterbuilder",level:3},{value:"Create SpigotImporter",id:"create-spigotimporter",level:3},{value:"Finish the builder",id:"finish-the-builder",level:3},{value:"Wizard UI",id:"wizard-ui",level:2},{value:"Create Wizard Panel",id:"create-wizard-panel",level:3},{value:"Create ImporterWizardUI",id:"create-importerwizardui",level:3},{value:"Register the UI",id:"register-the-ui",level:2}],d={toc:s};function u(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"This HowTo shows in about 20 minutes how to create a new spigot in Gephi. Spigots are like file importers, but with a different datasource. Spigots are the best way to import data from various data sources like Web Services, APIs, custom Databases or anything Java can read from. Like Importers, spigots push data to a ",(0,i.kt)("inlineCode",{parentName:"p"},"Container"),", which hosts all data collected (i.e. nodes, edges and attributes). Moreover, spigots user interface supports ",(0,i.kt)("strong",{parentName:"p"},"Wizards"),", which makes it easy to have rich settings and a consistent flow."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cloud.githubusercontent.com/assets/197285/5655355/6619c07a-96cd-11e4-9a36-f12aa7737433.png",alt:"spigot_menu"})),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Import Spigot Menu")),(0,i.kt)("p",null,"Please look at [","[Plugin Quick Start]","] to know how to create a new Netbeans Module. When you have your plugin module, that we will call ",(0,i.kt)("inlineCode",{parentName:"p"},"MySpigot"),", you can start this tutorial."),(0,i.kt)("p",null,"One can find spigot importer examples in the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/gephi/gephi/tree/master/modules/SpigotPlugin/"},"Gephi source code"),"."),(0,i.kt)("h2",{id:"create-a-new-importer"},"Create a new Importer"),(0,i.kt)("h3",{id:"set-dependencies"},"Set Dependencies"),(0,i.kt)("p",null,"Add [","[Import API]","], [","[LongTask API]","], [","[Utilities API]","], [","[Dialogs API]","] and [","[Lookup]","] modules as dependencies for your plugin module MySpigot. See [","[How To Set Module Dependencies]","]."),(0,i.kt)("h3",{id:"create-spigotimporterbuilder"},"Create SpigotImporterBuilder"),(0,i.kt)("p",null,"Importer Builder is a factory class for building the important instance, all Importers should have their own builder."),(0,i.kt)("p",null,"Create a new builder class, for instance ",(0,i.kt)("inlineCode",{parentName:"p"},"MySpigotBuilder")," that implements ",(0,i.kt)("a",{parentName:"p",href:"https://gephi.org/docs/api/org/gephi/io/importer/spi/SpigotImporterBuilder.html"},"SpigotImporterBuilder"),"."),(0,i.kt)("p",null,"Leave the ",(0,i.kt)("inlineCode",{parentName:"p"},"buildImporter()")," method empty for the moment and fill the ",(0,i.kt)("inlineCode",{parentName:"p"},"getName()")," methods like below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public String getName() {\n   return "My Spigot";\n}\n \npublic SpigotImporter buildImporter() {\n   return null;\n}\n')),(0,i.kt)("p",null,"Add ",(0,i.kt)("inlineCode",{parentName:"p"},"@ServiceProvider")," annotation to your builder class. Add the following line before ",(0,i.kt)("inlineCode",{parentName:"p"},"MySpigotBuilder")," class definition, as shown below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@ServiceProvider(service = SpigotImporterBuilder.class)\npublic class MySpigotBuilder implements SpigotImporterBuilder {\n...\n")),(0,i.kt)("h3",{id:"create-spigotimporter"},"Create SpigotImporter"),(0,i.kt)("p",null,"The importer is where the job will be done. Create a new spigot importer class, for instance ",(0,i.kt)("inlineCode",{parentName:"p"},"MySpigot")," that implements ",(0,i.kt)("a",{parentName:"p",href:"http://gephi.org/docs/api/org/gephi/io/importer/spi/SpigotImporter.html"},"SpigotImporter"),"."),(0,i.kt)("p",null,"For more details, have a look at ",(0,i.kt)("a",{parentName:"p",href:"http://gephi.org/docs/api/org/gephi/io/importer/api/ContainerLoader.html"},"ContainerLoader")," and ",(0,i.kt)("a",{parentName:"p",href:"http://gephi.org/docs/api/org/gephi/io/importer/api/Report.html"},"Report")," documentation."),(0,i.kt)("p",null,"Add also ",(0,i.kt)("inlineCode",{parentName:"p"},"LongTask")," interface to your class, in order you will be able to use progress and cancel management."),(0,i.kt)("p",null,"Your ",(0,i.kt)("inlineCode",{parentName:"p"},"MyImporter")," would look like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class MySpigot implements SpigotImporter, LongTask {\n \n    private ContainerLoader container;\n    private Report report;\n    private ProgressTicket progressTicket;\n    private boolean cancel = false;\n \n    public boolean execute(ContainerLoader loader) {\n        this.container = loader;\n        this.report = new Report();\n        //Import done here\n        return !cancel;\n    }\n \n    public ContainerLoader getContainer() {\n        return container;\n    }\n \n    public Report getReport() {\n        return report;\n    }\n \n    public boolean cancel() {\n        cancel = true;\n        return true;\n    }\n \n    public void setProgressTicket(ProgressTicket progressTicket) {\n        this.progressTicket = progressTicket;\n    }\n}\n")),(0,i.kt)("p",null,"The infrastructure is set, the container for pushing data, the report for pushing logs and errors, and the progress management."),(0,i.kt)("p",null,"Look at ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/gephi/gephi/tree/master/modules/ImportPlugin"},"File Importers examples")," or ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/gephi/gephi/tree/master/modules/SpigotPlugin/"},"Spigots examples")," code to learn how to push data to the container."),(0,i.kt)("h3",{id:"finish-the-builder"},"Finish the builder"),(0,i.kt)("p",null,"Go back to the ",(0,i.kt)("inlineCode",{parentName:"p"},"MySpigotBuilder")," and complete ",(0,i.kt)("inlineCode",{parentName:"p"},"buildImporter()")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public SpigotImporter buildImporter() {\n   return new MySpigot();\n}\n")),(0,i.kt)("h2",{id:"wizard-ui"},"Wizard UI"),(0,i.kt)("p",null,"You will create a ",(0,i.kt)("inlineCode",{parentName:"p"},"ImporterWizardUI")," class for your importer and learn how to create a wizard to configure your MySpigot."),(0,i.kt)("p",null,"A wizard is a set of panels, which follow each other with conditions. Consult the ",(0,i.kt)("a",{parentName:"p",href:"http://bits.netbeans.org/dev/javadoc/org-openide-dialogs/index.html?org/openide/WizardDescriptor.html"},"Wizard API Javadoc"),". One can also find a more general tutorial on Netbeans Wizards ",(0,i.kt)("a",{parentName:"p",href:"http://platform.netbeans.org/tutorials/nbm-wizard.html"},"here"),". The ImporterWizardUI class will provide the panels and the title of the spigot importer, as well as its description. But first, create a wizard panel."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cloud.githubusercontent.com/assets/197285/5655356/661d7828-96cd-11e4-9aba-f154068bf36c.png",alt:"spigot_howto1"})),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"My Spigot")),(0,i.kt)("h3",{id:"create-wizard-panel"},"Create Wizard Panel"),(0,i.kt)("p",null,"Create a new Java Panel class named ",(0,i.kt)("inlineCode",{parentName:"p"},"MySpigotWizardPanel1"),". Go to File > New File > Swing GUI Forms > JPanel Form."),(0,i.kt)("p",null,"Design your interface, by adding check boxes, text field etc. and go to the Source view."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cloud.githubusercontent.com/assets/197285/5655357/661ea37e-96cd-11e4-8c48-0ed3f7ec9490.png",alt:"spigot_howto_design"})),(0,i.kt)("p",null,"Create an ",(0,i.kt)("inlineCode",{parentName:"p"},"unsetup()")," method like below. This method will be called when the user leaves the wizard to actually configure your Spigot with the settings made in the UI."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public void unsetup(MySpigot importer) {\n   //Configure the importer\n \n   //Example\n   //importer.setOption(optionCheckbox.isSelected());\n}\n")),(0,i.kt)("p",null,"We will now edit this panel to implement the ",(0,i.kt)("a",{parentName:"p",href:"http://bits.netbeans.org/dev/javadoc/org-openide-dialogs/index.html?org/openide/WizardDescriptor.Panel.html"},"WizardDescriptor.Panel")," interface."),(0,i.kt)("p",null,"See below how to implement this class"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class MySpigotWizardPanel1 extends javax.swing.JPanel implements WizardDescriptor.Panel {\n \n    private List<ChangeListener> listeners; //these allow you to tell Gephi when UI changes are made\n \n \n    //Generated JPanel code goes here....\n \n \n    public Component getComponent() {\n        return this;\n    }\n \n    @Override\n    public String getName() {\n        return "Select Datasource";   //this will be the title of the panel in the wizard\n    }\n \n    @Override\n    public HelpCtx getHelp() {\n        return HelpCtx.DEFAULT_HELP;\n    }\n \n    /*\n     * You can use a settings object to keep track of state. Normally the\n     * settings object will be the WizardDescriptor, so you can use\n     * WizardDescriptor.getProperty & putProperty to store information entered\n     * by the user.\n     */\n    public void readSettings(Object settings) {\n    }\n \n    public void storeSettings(Object settings) {\n    }\n \n    public boolean isValid() {\n        return true;             //if you implement the change listeners properly, this should contain actual logic\n    }\n \n    @Override\n    public void addChangeListener(ChangeListener cl) {\n        if (listeners == null) {\n            listeners = new ArrayList();\n        }\n \n        listeners.add(cl);\n    }\n \n    @Override\n    public void removeChangeListener(ChangeListener cl) {\n        listeners.remove(cl);\n    }\n}\n')),(0,i.kt)("h3",{id:"create-importerwizardui"},"Create ImporterWizardUI"),(0,i.kt)("p",null,"Create a new spigot wizard UI class, for instance ",(0,i.kt)("inlineCode",{parentName:"p"},"MyImporterWizardUI")," that implements ",(0,i.kt)("a",{parentName:"p",href:"http://gephi.org/docs/api/org/gephi/io/importer/spi/ImporterWizardUI.html"},"ImporterWizardUI"),"."),(0,i.kt)("p",null,"This class is a singleton service, and registers your wizard in the system. It has two important methods: ",(0,i.kt)("inlineCode",{parentName:"p"},"setup()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"unsetup"),". The ",(0,i.kt)("inlineCode",{parentName:"p"},"unsetup()")," method is called when the wizard is closed and is responsible for configuring the actual Spigot importer. In other words, the UI push settings values to the importer not the contrary."),(0,i.kt)("p",null,"The sample below will help you:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class MySpigotWizardUI implements ImporterWizardUI {\n \n    private Panel[] panels = null;\n \n    @Override\n    public String getDisplayName() {\n        return "My Spigot Importer";\n    }\n \n    @Override\n    public String getCategory() {\n        return "My Spigot";\n    }\n \n    @Override\n    public String getDescription() {\n        return "My Spigot imports very cool data";\n    }\n \n    @Override\n    public Panel[] getPanels() {\n        if (panels == null) {\n            panels = new Panel[1];\n            panels[0] = new MySpigotWizardPanel1();\n        }\n        return panels;\n    }\n \n    @Override\n    public void setup(Panel panel) {\n        //Before opening the wizard\n    }\n \n    @Override\n    public void unsetup(SpigotImporter importer, Panel panel) {\n        //When the wizard has been closed\n        ((MySpigotWizardPanel1) ((Panel) panels[0]).getComponent()).unsetup((MySpigot)importer);\n \n        panels = null;\n    }\n \n    @Override\n    public boolean isUIForImporter(Importer importer) {\n        return importer instanceof MySpigot;\n    }\n}\n')),(0,i.kt)("p",null,"Notice how the ",(0,i.kt)("inlineCode",{parentName:"p"},"unsetup()")," method of ",(0,i.kt)("inlineCode",{parentName:"p"},"MySpigotWizardPanel1")," is called."),(0,i.kt)("p",null,"Ideally, this UI class is also responsible for saving the settings, in order to have the same settings the second time the spigot is used. For doing that, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"setup()")," method to load parameters in the panels. "),(0,i.kt)("h2",{id:"register-the-ui"},"Register the UI"),(0,i.kt)("p",null,"Add [","[@ServiceProvider]","] annotation to your UI class. Add the following line before ",(0,i.kt)("inlineCode",{parentName:"p"},"MySpigotWizardUI")," class definition, as shown below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@ServiceProvider(service = ImporterWizardUI.class)\npublic class MySpigotWizardUI implements ImporterWizardUI{\n...\n")))}u.isMDXComponent=!0}}]);